# LawFinder API 仕様書 v2.0

**作成日**: 2025 年 8 月 5 日  
**バージョン**: 2.0.0  
**ベース URL**: `http://localhost:5000/api`

## 1. 概要

LawFinder API は、法令データへのアクセスを提供する RESTful API です。Next.js API Routes を使用して実装されており、Prisma ORM を通じてデータベースにアクセスします。

## 2. 共通仕様

### 2.1 リクエスト形式

- **Content-Type**: `application/json`
- **文字エンコーディング**: UTF-8

### 2.2 レスポンス形式

- **Content-Type**: `application/json`
- **文字エンコーディング**: UTF-8

### 2.3 エラーレスポンス

```json
{
  "error": "エラーメッセージ"
}
```

### 2.4 HTTP ステータスコード

| コード | 説明                   |
| ------ | ---------------------- |
| 200    | 成功                   |
| 400    | リクエストエラー       |
| 404    | リソースが見つからない |
| 500    | サーバーエラー         |

## 3. エンドポイント

### 3.1 法令一覧取得

#### エンドポイント

```
GET /api/laws
```

#### パラメータ

| 名前   | 型     | 必須 | 説明           | デフォルト |
| ------ | ------ | ---- | -------------- | ---------- |
| page   | number | ×    | ページ番号     | 1          |
| limit  | number | ×    | 1 ページの件数 | 20         |
| search | string | ×    | 検索キーワード | -          |

#### リクエスト例

```
GET /api/laws?page=1&limit=20&search=民法
```

#### レスポンス例

```json
{
  "data": [
    {
      "id": "129AC0000000089",
      "title": "民法",
      "lawNumber": "明治二十九年法律第八十九号",
      "promulgationDate": null,
      "effectiveDate": null,
      "_count": {
        "articles": 1050
      }
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 8,
    "totalPages": 1
  }
}
```

### 3.2 法令詳細取得

#### エンドポイント

```
GET /api/laws/[id]
```

#### パラメータ

| 名前 | 型     | 必須 | 説明    |
| ---- | ------ | ---- | ------- |
| id   | string | ○    | 法令 ID |

#### リクエスト例

```
GET /api/laws/140AC0000000045
```

#### レスポンス例

```json
{
  "id": "140AC0000000045",
  "title": "刑法",
  "lawNumber": null,
  "metadata": {
    "lawNumber": "明治四十年法律第四十五号"
  },
  "enactStatements": {
    "text": "公布文省略"
  },
  "amendmentHistory": null,
  "articles": [
    {
      "id": "uuid-xxx",
      "articleNumber": "一",
      "articleTitle": "（国内犯）",
      "content": "第一条（国内犯）\n...",
      "paragraphs": [
        {
          "id": "uuid-yyy",
          "paragraphNumber": 1,
          "content": "この法律は、日本国内において罪を犯したすべての者に適用する。",
          "items": []
        }
      ],
      "referencesFrom": [
        {
          "id": "uuid-zzz",
          "referenceText": "第二条",
          "referenceType": "internal",
          "confidence": 0.9,
          "toArticle": {
            "id": "uuid-aaa",
            "articleNumber": "二",
            "law": {
              "id": "140AC0000000045",
              "title": "刑法"
            }
          }
        }
      ]
    }
  ]
}
```

### 3.3 参照関係取得

#### エンドポイント

```
GET /api/references
```

#### パラメータ

| 名前      | 型     | 必須 | 説明    |
| --------- | ------ | ---- | ------- |
| lawId     | string | ×    | 法令 ID |
| articleId | string | ×    | 条文 ID |

#### リクエスト例

```
GET /api/references?lawId=140AC0000000045
```

#### レスポンス例

```json
[
  {
    "id": "uuid-xxx",
    "fromArticleId": "uuid-aaa",
    "toArticleId": "uuid-bbb",
    "toLawId": null,
    "referenceText": "前条",
    "referenceType": "internal",
    "confidence": 0.9,
    "fromArticle": {
      "id": "uuid-aaa",
      "articleNumber": "二",
      "law": {
        "id": "140AC0000000045",
        "title": "刑法"
      }
    },
    "toArticle": {
      "id": "uuid-bbb",
      "articleNumber": "一",
      "law": {
        "id": "140AC0000000045",
        "title": "刑法"
      }
    }
  }
]
```

## 4. データモデル

### 4.1 Law（法令）

| フィールド       | 型      | 説明                           |
| ---------------- | ------- | ------------------------------ |
| id               | string  | 法令 ID（例: 140AC0000000045） |
| title            | string  | 法令名                         |
| lawNumber        | string? | 法令番号                       |
| metadata         | JSON?   | メタデータ                     |
| enactStatements  | JSON?   | 制定文                         |
| amendmentHistory | JSON?   | 改正履歴                       |

### 4.2 Article（条文）

| フィールド    | 型      | 説明            |
| ------------- | ------- | --------------- |
| id            | string  | 条文 ID（UUID） |
| lawId         | string  | 法令 ID         |
| articleNumber | string  | 条番号          |
| articleTitle  | string? | 条見出し        |
| content       | string  | 条文全文        |

### 4.3 Paragraph（項）

| フィールド      | 型     | 説明          |
| --------------- | ------ | ------------- |
| id              | string | 項 ID（UUID） |
| articleId       | string | 条文 ID       |
| paragraphNumber | number | 項番号        |
| content         | string | 項の内容      |

### 4.4 Item（号）

| フィールド  | 型     | 説明          |
| ----------- | ------ | ------------- |
| id          | string | 号 ID（UUID） |
| paragraphId | string | 項 ID         |
| itemNumber  | string | 号番号        |
| content     | string | 号の内容      |

### 4.5 Reference（参照関係）

| フィールド    | 型      | 説明                            |
| ------------- | ------- | ------------------------------- |
| id            | string  | 参照 ID（UUID）                 |
| fromArticleId | string  | 参照元条文 ID                   |
| toArticleId   | string? | 参照先条文 ID                   |
| toLawId       | string? | 参照先法令 ID                   |
| referenceText | string  | 参照テキスト                    |
| referenceType | string  | 参照タイプ（internal/external） |
| confidence    | number? | 信頼度スコア                    |

## 5. 使用例

### 5.1 JavaScript/TypeScript

```typescript
// 法令一覧を取得
const response = await fetch("/api/laws?page=1&limit=10");
const { data, pagination } = await response.json();

// 特定の法令を取得
const lawResponse = await fetch("/api/laws/140AC0000000045");
const law = await lawResponse.json();

// 参照関係を取得
const refResponse = await fetch("/api/references?lawId=140AC0000000045");
const references = await refResponse.json();
```

### 5.2 cURL

```bash
# 法令一覧を取得
curl http://localhost:5000/api/laws

# 法令を検索
curl "http://localhost:5000/api/laws?search=刑法"

# 法令詳細を取得
curl http://localhost:5000/api/laws/140AC0000000045
```

## 6. 制限事項

- レート制限: なし（開発環境）
- 最大リクエストサイズ: 10MB
- タイムアウト: 30 秒
- ページあたり最大件数: 100

## 7. 今後の拡張予定

- 認証機能（JWT）
- GraphQL 対応
- WebSocket（リアルタイム更新）
- バッチ操作 API
- 全文検索 API（Elasticsearch 統合後）
