# CLAUDE.md

このファイルは、Claude Code (claude.ai/code) がこのリポジトリのコードを扱う際のガイダンスを提供します。

## プロジェクト概要

LawFinder は、政府が公開する法的標準 XML ファイルを処理する日本の法文書検索・法改正支援アプリケーションです。システムは法的構造の可視化、法律間の相互参照の検出、改正影響（「はね改正」）の分析を目的としています。

## プロジェクト状況（2025年8月4日更新）

**Phase 1（静的サイト生成）が完了しました。** 以下の機能が実装済みです：

### 実装済み機能
- ✅ 政府標準XML形式の完全な解析
- ✅ 複雑な参照パターンの検出（同項第二号、前項第一号など）
- ✅ e-Gov風の洗練されたUI
- ✅ インタラクティブな参照ナビゲーション
- ✅ ローカルLLM統合（Ollama/Mistral）
- ✅ 階層目次の完全再現（編・章・節・条・項・号）

### 技術スタック（実装済み）
- **静的サイト生成**: Node.js カスタムスクリプト
- **XMLパーサー**: 正規表現ベースのカスタムパーサー
- **スタイル**: e-Gov準拠のカスタムCSS
- **LLM統合**: Ollama REST API（Mistralモデル）
- **アーキテクチャ**: ドメイン駆動設計（DDD）

### Phase 2で計画されている技術
- フロントエンド: React/Next.js
- バックエンド: Express.js（TypeScript）
- 検索エンジン: Elasticsearch 8.x
- グラフデータベース: Neo4j
- LLM統合: OpenAI GPT-4o API（追加）

## データ構造

プロジェクトには以下が含まれています：

- `/laws_data/` - 政府標準 XML 形式の日本の政府法データを含むディレクトリ
- `/laws_data/all_law_list.csv` - メタデータ付きの全法律のマスターリスト
- 各法律は独自のディレクトリに格納され、XML ファイルは政府標準形式に従います

## 開発の進め方

### 実装済みスクリプトの使用

```bash
# 静的サイト生成（実LLM版）
node scripts/build-static-llm.js

# 開発サーバー起動
npm run serve  # http://localhost:8080

# LLM APIの状態確認
./scripts/startup.sh
```

### Phase 2の開発タスク

1. **API層の実装**
   - Express.js REST API設定
   - 既存の参照検出エンジンをAPIとして公開
   - PostgreSQL/Prismaのスキーマ定義
   - Neo4j統合

2. **フロントエンド刷新**
   - Next.js 14セットアップ
   - 既存の静的HTMLをReactコンポーネント化
   - API統合
   - 状態管理（Zustand/Redux）

3. **高度な機能実装**
   - 改正影響分析エンジン
   - OpenAI GPT-4o統合
   - リアルタイム更新機能

## 重要な考慮事項

- すべての文書は日本語です - 全体を通じて日本語サポートを維持してください
- XML ファイルは特定の政府標準形式に従っており、これを保持する必要があります
- 相互参照検出には、パターンマッチングと AI 支援検証の両方が必要です
- システムは複雑な法的用語と参照を正確に処理する必要があります
